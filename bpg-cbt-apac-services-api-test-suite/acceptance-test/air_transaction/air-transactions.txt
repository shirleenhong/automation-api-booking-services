*** Settings ***
Resource          ../resources/api-variables.txt
Resource          ../resources/api-utilities.txt
Resource          ../resources/api-imports.txt
Resource    resources/air-transactions.txt

Suite Setup    Generate Suite Variables For Air Transaction    cc_vendor_data_list=TP,Airplus|DC,Diners|CA,Mastercard|AX,Amex|VI,VISA    rbd_data_list=G,ECONOMY|Q,ECONOMY|C,EXECUTIVE|I,ECONOMY|L,ECONOMY    airline_data_list=AB,Air Berlin|SG,SpiceJet|AA,American Airlines|TST,Test Airline|TST1,Test Airline 1|TST2,Test Airline 2|TST3,Test Airline 3|4L,Georgian International Airlines  

*** Test Cases ***
Verify That Air Transactions Return Correct Passthrough Type For Full Passthrough In Client Level
    [Tags]    functional
    Create Test Variable For Air Transaction    data_list=CX,AX,NRCC,3021300025,Airline;Q
    Send Air Transaction Get Request
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Passthrough Type Is Retrieved Correctly  
    
Verify That Air Transactions Return Correct Passthrough Type For Non-Passthrough In Client Level
    [Tags]    functional
    Create Test Variable For Air Transaction    data_list=AF,CA,NRCC,3104300001,CWT;G
    Send Air Transaction Get Request
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Passthrough Type Is Retrieved Correctly
    
Verify That Air Transactions Return Correct Passthrough Type For Selective Passthrough In Client Level
    [Tags]    functional
    Create Test Variable For Air Transaction    data_list=TST,AX,UATP,2222222222,Airline;Q
    Send Air Transaction Put Request (Maintenance)
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache
    Send Air Transaction Get Request
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Passthrough Type Is Retrieved Correctly
    Create Test Variable For Air Transaction    data_list=TST,AX,UATP,2222222222,CWT;L,C,G
    Send Air Transaction Put Request (Maintenance)
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache
    Send Air Transaction Get Request    booking_class=L
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Passthrough Type Is Retrieved Correctly
    [Teardown]    Delete Created Air Transaction And Evict Cache    
    
Verify That Air Transactions Return Correct Passthrough Type For Full Passthrough In Country Level
    [Tags]    functional
    Create Test Variable For Air Transaction    data_list=1A,AX,NRCC,${EMPTY},Airline;Q
    Send Air Transaction Get Request
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Passthrough Type Is Retrieved Correctly  
    
Verify That Air Transactions Return Correct Passthrough Type For Non-Passthrough In Country Level
    [Tags]    functional
    Create Test Variable For Air Transaction    data_list=4L,CA,UATP,${EMPTY},CWT;G
    Send Air Transaction Get Request
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Passthrough Type Is Retrieved Correctly   

Verify That Air Transactions Return Correct Passthrough Type For Selective Passthrough Type In Country Level
    [Tags]    functional
    Create Test Variable For Air Transaction    data_list=TG,AX,NRCC,${EMPTY},CWT;L
    Send Air Transaction Get Request
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Passthrough Type Is Retrieved Correctly
    Create Test Variable For Air Transaction    data_list=TG,VI,NRCC,${EMPTY},Airline;Q
    Send Air Transaction Get Request
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Passthrough Type Is Retrieved Correctly  

Verify That Air Transactions Return Correct Passthrough Type For Multiple Booking Class
    [Tags]    functional
    #Mixed Passthrough Type
    Create Test Variable For Air Transaction    data_list=TST,CA,NRCC,1111111111,CWT;C
    Send Air Transaction Put Request (Maintenance)
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache
    Create Test Variable For Air Transaction    data_list=TST,CA,NRCC,1111111111,Airline;Q
    Send Air Transaction Put Request (Maintenance)
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache
    Create Test Variable For Air Transaction    data_list=TST,CA,NRCC,1111111111,Airline;L
    Send Air Transaction Put Request (Maintenance)
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache
    Send Air Transaction Get Request (Maintenance)    airline_code=TST    client_account_number=1111111111
    Evict Air Transaction Cache
    Create Test Variable For Air Transaction    data_list=TST,CA,NRCC,1111111111,CWT;C,Q,L
    Send Air Transaction Get Request
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Passthrough Type Is Retrieved Correctly
    #Single Passthrough Type - CWT
    Create Test Variable For Air Transaction    data_list=TST1,CA,NRCC,1111111111,CWT;C
    Send Air Transaction Put Request (Maintenance)
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache
    Create Test Variable For Air Transaction    data_list=TST1,CA,NRCC,1111111111,CWT;Q
    Send Air Transaction Put Request (Maintenance)
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache
    Send Air Transaction Get Request (Maintenance)    airline_code=TST    client_account_number=1111111111
    Evict Air Transaction Cache
    Create Test Variable For Air Transaction    data_list=TST1,CA,NRCC,1111111111,CWT;C,Q
    Send Air Transaction Get Request
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Passthrough Type Is Retrieved Correctly
    #Single Passthrough Type - Airline
    Create Test Variable For Air Transaction    data_list=TST2,CA,NRCC,1111111111,Airline;C
    Send Air Transaction Put Request (Maintenance)
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache
    Create Test Variable For Air Transaction    data_list=TST2,CA,NRCC,1111111111,Airline;Q
    Send Air Transaction Put Request (Maintenance)
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache
    Send Air Transaction Get Request (Maintenance)    airline_code=TST    client_account_number=1111111111
    Evict Air Transaction Cache
    Create Test Variable For Air Transaction    data_list=TST2,CA,NRCC,1111111111,Airline;C,Q
    Send Air Transaction Get Request
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Passthrough Type Is Retrieved Correctly
    [Teardown]    Delete Created Air Transaction And Evict Cache    

Verify That Air Transactions Are Correctly Retrieved
    [Tags]    functional
    Create Test Variable For Air Transaction    data_list=AA,AX,NRCC,3104300001,CWT;null|AA,VI,UATP,3104300001,CWT;null    consumer=maintenance
    Send Air Transaction Get Request (Maintenance)    client_account_number=3104300001
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Retrieved Correctly
    [Teardown]    Evict Air Transaction Cache    
    
Verify That Air Transactions Are Updated Correctly After Put Request
    [Tags]    functional
    #Single Booking Class
    Create Test Variable For Air Transaction    data_list=TST1,CA,NRCC,1111111111,CWT;C    consumer=maintenance
    Send Air Transaction Put Request (Maintenance)
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache
    Send Air Transaction Get Request (Maintenance)    airline_code=TST1    client_account_number=1111111111
    Verify Air Transaction Record Is Retrieved Correctly
    #Multiple Booking Class
    Create Test Variable For Air Transaction    data_list=TST2,CA,NRCC,1111122222,CWT;C,G,Q        consumer=maintenance
    Send Air Transaction Put Request (Maintenance)
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache
    Send Air Transaction Get Request (Maintenance)    airline_code=TST2    client_account_number=1111122222
    Verify Air Transaction Record Is Retrieved Correctly
    #No Client Account Number
    Create Test Variable For Air Transaction    data_list=TST3,CA,NRCC,null,CWT;C,G,Q    consumer=maintenance
    Send Air Transaction Put Request (Maintenance)
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache
    Send Air Transaction Get Request (Maintenance)    airline_code=TST3
    Verify Air Transaction Record Is Retrieved Correctly
    [Teardown]    Delete Created Air Transaction And Evict Cache
    
Verify That Air Transactions Are Deleted Correctly After Delete Request
    [Tags]    functional
    Create Test Variable For Air Transaction    data_list=TST,CA,NRCC,1111111111,CWT;C
    Send Air Transaction Put Request (Maintenance) 
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Saved Correctly
    Evict Air Transaction Cache    
    Send Air Transaction Delete Request (Maintenance)     
    Verify Response Status Code Is Correct    200
    Evict Air Transaction Cache
    Send Air Transaction Get Request (Maintenance)     airline_code=TST    client_account_number=1111111111 
    Verify Response Status Code Is Correct    200
    Verify Air Transaction Record Is Not Retrieved
    [Teardown]    Evict Air Transaction Cache    