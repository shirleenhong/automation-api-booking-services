*** Setting ***
Resource    ../../resources/api-imports.txt
Resource    ../../resources/api-utilities.txt
Resource    ../../resources/api-variables.txt

***Keywords***
Append Exchange Order Credit Card Request Fields
    [Arguments]    ${exchange_order_cc_request_list}
    Run Keyword If    "${cc_type_value}"!="null"    Append To List    ${exchange_order_cc_request_list}    "ccType":"${cc_type_value}"
    Run Keyword If    "${cc_number_value}"!="null"    Append To List    ${exchange_order_cc_request_list}    "ccNumber":"${cc_number_value}"
    Run Keyword If    "${expiry_date_value}"!="null"    Append To List    ${exchange_order_cc_request_list}    "expiryDate":"${expiry_date_value}"
    Set Test Variable    ${exchange_order_cc_request_list}
    
Append Exchange Order Header Request Fields
    [Arguments]    ${exchange_order_header_request_list}
    Run Keyword If    "${header_address_value}"!="null"    Append To List    ${exchange_order_header_request_list}    "address":"${header_address_value}"
    Run Keyword If    "${header_telephone_value}"!="null"    Append To List    ${exchange_order_header_request_list}    "phoneNumber":"${header_telephone_value}"
    Run Keyword If    "${header_fax_value}"!="null"    Append To List    ${exchange_order_header_request_list}    "faxNumber":"${header_fax_value}"
    Set Test Variable    ${exchange_order_header_request_list}
    
Append Exchange Order Remarks Request Fields
    [arguments]    ${exchange_order_eo_rmk_request_list}    ${exchange_order_itin_rmk_request_list}
    : FOR    ${eo_index}    IN RANGE    0    ${eo_remarks_data_length}
    \    ${eo_remarks_parameter_list}    Set Variable    "${eo_remark_text_${eo_index}}"
    \    Append To List    ${exchange_order_eo_rmk_request_list}    ${eo_remarks_parameter_list}
    : FOR    ${itin_index}    IN RANGE    0    ${itin_remarks_data_length}
    \    ${itin_remarks_parameter_list}    Set Variable    "${itin_remark_text_${itin_index}}"
    \    Append To List    ${exchange_order_itin_rmk_request_list}    ${itin_remarks_parameter_list}
    Set Test Variable    ${exchange_order_eo_rmk_request_list}
    Set Test Variable    ${exchange_order_itin_rmk_request_list}

Append Exchange Order Request Fields
    [Arguments]    ${exchange_order_request_list}
    Run Keyword If    "${account_number_value}"!="null"    Append To List    ${exchange_order_request_list}    "accountNumber":"${account_number_value}"
    Run Keyword If    "${date_value}"!="null"    Append To List    ${exchange_order_request_list}    "additionalInfoDate":"${date_value}"
    Run Keyword If    "${agent_id_value}"!="null"    Append To List    ${exchange_order_request_list}    "agentId":"${agent_id_value}"
    Run Keyword If    "${agent_name_value}"!="null"    Append To List    ${exchange_order_request_list}    "agentName":"${agent_name_value}"
    Run Keyword If    "${bta_description_value}"!="null"    Append To List    ${exchange_order_request_list}    "btaDescription":"${bta_description_value}"
    Run Keyword If    "${commission_value}"!="null"    Append To List    ${exchange_order_request_list}    "commission":${commission_value}
    Run Keyword If    "${country_value}"!="null"    Append To List    ${exchange_order_request_list}    "countryCode":"${country_value}"
    Run Keyword If    "${description_value}"!="null"    Append To List    ${exchange_order_request_list}    "description":"${description_value}"
    Run Keyword If    "${eo_action_value}"!="null"    Append To List    ${exchange_order_request_list}    "eoAction":"${eo_action_value}"
    Run Keyword If    "${fop_type_value}"!="null"    Append To List    ${exchange_order_request_list}    "fopType":"${fop_type_value}"
    Run Keyword If    "${gst_absorb_value}"!="null"    Append To List    ${exchange_order_request_list}    "gstAbsorb":${gst_absorb_value}
    Run Keyword If    "${gst_amount_value}"!="null"    Append To List    ${exchange_order_request_list}    "gstAmount":${gst_amount_value}
    Run Keyword If    "${merchant_fee_value}"!="null"    Append To List    ${exchange_order_request_list}    "merchantFee":${merchant_fee_value}
    Run Keyword If    "${merchant_fee_absorb_value}"!="null"    Append To List    ${exchange_order_request_list}    "merchantFeeAbsorb":${merchant_fee_absorb_value}
    Run Keyword If    "${nett_cost_value}"!="null"    Append To List    ${exchange_order_request_list}    "nettCost":${nett_cost_value}
    Run Keyword If    "${passenger_name_value}"!="null"    Append To List    ${exchange_order_request_list}    "passengerName":"${passenger_name_value}"
    Run Keyword If    "${pcc_value}"!="null"    Append To List    ${exchange_order_request_list}    "pcc":"${pcc_value}"    
    Run Keyword If    "${product_code_value}"!="null"    Append To List    ${exchange_order_request_list}    "productCode":"${product_code_value}"
    Run Keyword If    "${raise_cheque_value}"!="null"    Append To List    ${exchange_order_request_list}    "raiseCheque":"${raise_cheque_value}"
    Run Keyword If    "${record_locator_value}"!="null"    Append To List    ${exchange_order_request_list}    "recordLocator":"${record_locator_value}"
    Run Keyword If    "${selling_price_value}"!="null"    Append To List    ${exchange_order_request_list}    "sellingPrice":${selling_price_value}
    Run Keyword If    "${status_value}"!="null"    Append To List    ${exchange_order_request_list}    "status":"${status_value}"
    Run Keyword If    "${tax_1_value}"!="null"    Append To List    ${exchange_order_request_list}    "tax1":${tax_1_value}
    Run Keyword If    "${tax_2_value}"!="null"    Append To List    ${exchange_order_request_list}    "tax2":${tax_2_value}
    Run Keyword If    "${total_value}"!="null"    Append To List    ${exchange_order_request_list}    "total":${total_value}
    Run Keyword If    "${total_selling_price_value}"!="null"    Append To List    ${exchange_order_request_list}    "totalSellingPrice":${total_selling_price_value}
    Set Test Variable    ${exchange_order_request_list}

Append Exchange Order Vendor Request Fields
    [Arguments]    ${exchange_order_vendor_request_list}
    Run Keyword If    "${vendor_contact_value}"!="null"    Append To List    ${exchange_order_vendor_request_list}    "contactPerson":"${vendor_contact_value}"
    Run Keyword If    "${vendor_email_value}"!="null"    Append To List    ${exchange_order_vendor_request_list}    "email":"${vendor_email_value}"
    Run Keyword If    "${vendor_fax_value}"!="null"    Append To List    ${exchange_order_vendor_request_list}    "faxNumber":"${vendor_fax_value}"
    Run Keyword If    "${vendor_code_value}"!="null"    Append To List    ${exchange_order_vendor_request_list}    "code":"${vendor_code_value}"
    Run Keyword If    "${vendor_name_value}"!="null"    Append To List    ${exchange_order_vendor_request_list}    "name":"${vendor_name_value}"
    Run Keyword If    "${vendor_address_1_value}"!="null"    Append To List    ${exchange_order_vendor_request_list}    "address1":"${vendor_address_1_value}"
    Run Keyword If    "${vendor_address_2_value}"!="null"    Append To List    ${exchange_order_vendor_request_list}    "address2":"${vendor_address_2_value}"
    Run Keyword If    "${vendor_city_value}"!="null"    Append To List    ${exchange_order_vendor_request_list}    "city":"${vendor_city_value}"
    Run Keyword If    "${vendor_country_value}"!="null"    Append To List    ${exchange_order_vendor_request_list}    "country":"${vendor_country_value}"
    Run Keyword If    "${vendor_contact_number_value}"!="null"    Append To List    ${exchange_order_vendor_request_list}    "contactNo":"${vendor_contact_number_value}"
    Set Test Variable    ${exchange_order_vendor_request_list}

Create Test Variables For Exchange Order
    [Arguments]    ${eo_data}    ${eo_remarks_data}=${EMPTY}    ${itin_remarks_data}=${EMPTY}
    ${eo_data_list}    Split String    ${eo_data}    |
    Set Test Variable    ${eo_data_list}
    : FOR    ${data}    IN    @{eo_data_list}
    \    ${data_item}    Split String    ${data}    ,
    \    Set Test Variable    ${${data_item[0]}_value}    ${data_item[1]}
    Run Keyword If    "${eo_remarks_data}"!="${EMPTY}"    Create Test Variables For Exchange Order Remarks    ${eo_remarks_data}    ELSE    Run Keywords    Set Test Variable    ${eo_remarks_list}    ${EMPTY}    AND    Set Test Variable    ${eo_remarks_data_length}    0
    Run Keyword If    "${itin_remarks_data}"!="${EMPTY}"    Create Test Variables For Itinerary Remarks    ${itin_remarks_data}    ELSE    Run Keywords    Set Test Variable    ${itin_remarks_list}    ${EMPTY}    AND    Set Test Variable    ${itin_remarks_data_length}    0
    ${current_date_time}    Get Current Date    time_zone=utc
    ${current_year}    Get Substring    ${current_date_time}     2    4
    ${current_month}    Get Substring    ${current_date_time}    5    7
    ${market}    Set Variable If    "${country_value}"=="HK"    1    "${country_value}"=="SG"    2    3
    Set Test Variable    ${current_date_time}
    Set Test Variable    ${current_year}
    Set Test Variable    ${current_month}
    Set Test Variable    ${market}
    ${year}    Get Substring    ${current_date_time}     0    4
    ${month}    Set Variable If    "${current_month}"=="01"    Jan    "${current_month}"=="02"    Feb    "${current_month}"=="03"    Mar    "${current_month}"=="04"    Apr    "${current_month}"=="05"    May    "${current_month}"=="06"    Jun    "${current_month}"=="07"    Jul    "${current_month}"=="08"    Aug    "${current_month}"=="09"    Sep    "${current_month}"=="10"    Oct    "${current_month}"=="11"    Nov    Dec
    ${day}    Get Substring    ${current_date_time}     8    10
    Set Test Variable    ${display_date}    ${day}-${month}-${year}
    ${year}    Get Substring    ${date_value}     0    4
    ${month}    Get Substring    ${date_value}    5    7
    ${day}    Get Substring    ${date_value}     8    10    
    ${month}    Set Variable If    "${month}"=="01"    Jan    "${month}"=="02"    Feb    "${month}"=="03"    Mar    "${month}"=="04"    Apr    "${month}"=="05"    May    "${month}"=="06"    Jun    "${month}"=="07"    Jul    "${month}"=="08"    Aug    "${month}"=="09"    Sep    "${month}"=="10"    Oct    "${month}"=="11"    Nov    Dec
    Set Test Variable    ${display_additional_info_date}     ${day}-${month}-${year}                

Create Exchange Order Request
    ${eo_rmk_list_length}    Get Length    ${exchange_order_eo_rmk_request_list}
    : FOR    ${i}    IN RANGE    0    ${eo_rmk_list_length}
    \    ${eo_rmk_list}    Set Variable If    ${i}==0    ${EMPTY}    ${eo_rmk_list},
    \    ${eo_rmk_list}    Set Variable    ${eo_rmk_list}${exchange_order_eo_rmk_request_list[${i}]}
    ${eo_rmk_list}    Set Variable If    "${eo_rmk_list_length}"=="0"    ${EMPTY}    ${eo_rmk_list}
    ${itin_rmk_list_length}    Get Length    ${exchange_order_itin_rmk_request_list}
    : FOR    ${i}    IN RANGE    0    ${itin_rmk_list_length}
    \    ${itin_rmk_list}    Set Variable If    ${i}==0    ${EMPTY}    ${itin_rmk_list},
    \    ${itin_rmk_list}    Set Variable    ${itin_rmk_list}${exchange_order_itin_rmk_request_list[${i}]}
    ${itin_rmk_list}    Set Variable If    "${itin_rmk_list_length}"=="0"    ${EMPTY}    ${itin_rmk_list}
    ${list_count}    Get Length    ${exchange_order_request_list}
    : FOR    ${i}    IN RANGE    0    ${list_count}
    \    ${eo_list}    Set Variable If    ${i}==0    ${EMPTY}    ${eo_list},
    \    ${eo_list}    Set Variable    ${eo_list}${exchange_order_request_list[${i}]}
    ${cc_list_count}    Get Length    ${exchange_order_cc_request_list}
    : FOR    ${i}    IN RANGE    0    ${cc_list_count}
    \    ${cc_list}    Set Variable If    ${i}==0    ${EMPTY}    ${cc_list},
    \    ${cc_list}    Set Variable    ${cc_list}${exchange_order_cc_request_list[${i}]}    
    ${header_list_count}    Get Length   ${exchange_order_header_request_list}
    : FOR    ${i}    IN RANGE    0    ${header_list_count}
    \    ${header_list}    Set Variable If    ${i}==0    ${EMPTY}    ${header_list},
    \    ${header_list}    Set Variable    ${header_list}${exchange_order_header_request_list[${i}]}
    ${vendor_list_count}    Get Length   ${exchange_order_vendor_request_list}
    : FOR    ${i}    IN RANGE    0    ${vendor_list_count}
    \    ${vendor_list}    Set Variable If    ${i}==0    ${EMPTY}    ${vendor_list},
    \    ${vendor_list}    Set Variable    ${vendor_list}${exchange_order_vendor_request_list[${i}]}      
    ${data}    Set Variable    {${eo_list},"creditCard":{${cc_list}},"itineraryRemarks":[${itin_rmk_list}],"eoRemarks":[${eo_rmk_list}],"header":{${header_list}},"vendor":{${vendor_list}}}
    ${data}    Replace String    ${data}    "creditCard":{},    ${EMPTY}
    ${data}    Replace String    ${data}    "NULL"    null
    ${data}    Replace String    ${data}    "None"    None
    Set Test Variable    ${data}
    Log    ${data}
    
Create Test Variables For Exchange Order Remarks
    [Arguments]    ${eo_remarks_data}
    ${eo_remarks_data}    Split String    ${eo_remarks_data}    ,
    ${eo_remarks_data_length}    Get Length    ${eo_remarks_data}
    Set Test Variable    ${eo_remarks_data}
    Set Test Variable    ${eo_remarks_data_length}    
    : FOR    ${index}    IN RANGE    0    ${eo_remarks_data_length}
    \    Set Test Variable    ${eo_remark_text_${index}}     ${eo_remarks_data[${index}]}

Create Test Variables For Itinerary Remarks
    [Arguments]    ${itin_remarks_data}
    ${itin_remarks_data}    Split String    ${itin_remarks_data}    ,
    ${itin_remarks_data_length}    Get Length    ${itin_remarks_data}
    Set Test Variable    ${itin_remarks_data}
    Set Test Variable    ${itin_remarks_data_length}    
    : FOR    ${index}    IN RANGE    0    ${itin_remarks_data_length}
    \    Set Test Variable    ${itin_remark_text_${index}}     ${itin_remarks_data[${index}]}

Decode String Response
    Create Binary File    ${CURDIR}${/}test.pdf   ${response.content}
    ${pdf_response}    Get Pdf Text    ${CURDIR}${/}test.pdf
    Set Test Variable    ${pdf_response}
    Log    ${pdf_response}
    
Send Exchange Order Get Request
    [Arguments]    ${exchange_order_number}=${exchange_order_number}    ${token}=${default_token}
    Create Session    exchange-order    ${${env}_base_url}    verify=True
    ${headers}    Run Keyword If    "${token}" != "None"    Create Dictionary    Content-Type=application/json    Authorization=Bearer ${token}
    ...    ELSE    Create Dictionary    Content-Type=application/json
    ${response}    Get Request    exchange-order    /apac-services-rest/api/exchange-order/${exchange_order_number}    headers=${headers}
    Set Test Variable    ${response}
    Log    ${response.headers}
    Log    ${response.content}
    Set Test Variable    ${api_flag}    exchange-order

Send Exchange Order PDF Get Request
    [Arguments]    ${token}=${default_token}    ${exchange_order_number}=${exchange_order_number}
    Create Session    exchange-order    ${${env}_base_url}    verify=True
    ${headers}    Run Keyword If    "${token}" != "None"    Create Dictionary    Content-Type=application/json    Authorization=Bearer ${token}
    ...    ELSE    Create Dictionary    Content-Type=application/json
    ${response}    Get Request    exchange-order    /apac-services-rest/api/exchange-order/pdf/${exchange_order_number}    headers=${headers}
    Set Test Variable    ${response}
    Log    ${response.headers}
    Log    ${response.content}
    Set Test Variable    ${api_flag}    exchange-order

Send Exchange Order Post Request
    [Arguments]    ${token}=${default_token}
    Create Session    exchange-order    ${${env}_base_url}    verify=True
    ${headers}    Run Keyword If    "${token}" != "None"    Create Dictionary    Content-Type=application/json    Authorization=Bearer ${token}
    ...    ELSE    Create Dictionary    Content-Type=application/json
    ${exchange_order_request_list}    Create List
    ${exchange_order_cc_request_list}    Create List
    ${exchange_order_eo_rmk_request_list}    Create List
    ${exchange_order_itin_rmk_request_list}    Create List
    ${exchange_order_header_request_list}    Create List
    ${exchange_order_vendor_request_list}    Create List
    Append Exchange Order Request Fields    ${exchange_order_request_list}
    Append Exchange Order Header Request Fields    ${exchange_order_header_request_list}
    Run Keyword If    "${fop_type_value}"=="CC" or "${fop_type_value}"=="CX4"    Append Exchange Order Credit Card Request Fields    ${exchange_order_cc_request_list}    ELSE    Run Keywords    Set Test Variable    ${exchange_order_cc_request_list}    ${EMPTY}    AND    Set Test Variable    ${cc_list}    ${EMPTY}
    Append Exchange Order Remarks Request Fields    ${exchange_order_eo_rmk_request_list}    ${exchange_order_itin_rmk_request_list}
    Append Exchange Order Vendor Request Fields    ${exchange_order_vendor_request_list}
    Create Exchange Order Request
    ${response}    Post Request    exchange-order    /apac-services-rest/api/exchange-order    data=${data}    headers=${headers}
    Set Test Variable    ${response}
    Log    ${response.headers}
    Log    ${response.content}
    Set Test Variable    ${api_flag}    exchange-order

Verify Exchange Order Information For PDF Is Retrieved Correctly
    Decode String Response
    Verify Static Labels Is Retrieved Correctly
    Verify String Contains Substring    ${pdf_response}    ${display_date}
    Verify String Contains Substring    ${pdf_response}    ${display_additional_info_date}
    Verify String Contains Substring    ${pdf_response}    ${agent_id_value}
    Verify String Contains Substring    ${pdf_response}    ${agent_name_value}
    Run Keyword If    "${bta_description_value}"!="null"    Verify String Contains Substring    ${pdf_response}    ${bta_description_value}    ELSE    Verify String Does Not Contain Substring    ${pdf_response}    ${bta_description_value}
    Verify String Contains Substring    ${pdf_response}    ${description_value}
    Verify String Contains Substring    ${pdf_response}    ${exchange_order_number}
    Run Keyword If    "${gst_amount_value}"!="null" or "${gst_amount_value}"!="0"    Verify String Contains Substring    ${pdf_response}    ${gst_amount_value}
    Verify String Contains Substring    ${pdf_response}    ${header_address_value}
    Run Keyword If    "${header_fax_value}"!="null"    Verify String Contains Substring    ${pdf_response}    ${header_fax_value}    ELSE    Verify String Does Not Contain Substring    ${pdf_response}    ${header_fax_value}
    Run Keyword If    "${header_telephone_value}"!="null"    Verify String Contains Substring    ${pdf_response}    ${header_telephone_value}    ELSE    Verify String Does Not Contain Substring    ${pdf_response}    ${header_telephone_value}
    Run Keyword If    "${nett_cost_value}"!="null"    Verify String Contains Substring    ${pdf_response}    ${nett_cost_value}    ELSE    Verify String Does Not Contain Substring    ${pdf_response}    ${nett_cost_value}
    Verify String Contains Substring    ${pdf_response}    ${passenger_name_value}
    Verify String Contains Substring    ${pdf_response}    ${record_locator_value}
    Run Keyword If    ("${gst_amount_value}"=="null" or "${gst_amount_value}"=="0") and "${tax_1_value}"!="null"    Verify String Contains Substring    ${pdf_response}    ${tax_1_value}    ELSE    Verify String Does Not Contain Substring    ${pdf_response}    ${tax_1_value}
    Run Keyword If    ("${tax_1_value}"!="null" or "${tax_1_value}"!="0") and "${tax_2_value}"!="null"    Verify String Contains Substring    ${pdf_response}    ${tax_2_value}	ELSE    Verify String Does Not Contain Substring    ${pdf_response}    ${tax_2_value}  
    ${total_value}    Run Keyword If    "${country_value.upper()}"=="SG"    Convert To Number    ${total_value}    ELSE    Convert To Integer    ${total_value}    
    ${total_value}    Format Number    ${total_value}
    Verify String Contains Substring    ${pdf_response}    ${total_value}
    Run Keyword If    "${vendor_email_value}"!="null"    Verify String Contains Substring    ${pdf_response}    ${vendor_email_value}    ELSE    Verify String Does Not Contain Substring    ${pdf_response}    ${vendor_email_value}
    Verify String Contains Substring    ${pdf_response}    ${vendor_fax_value}
    Run Keyword If    "${vendor_contact_value}"!="null"    Verify String Contains Substring    ${pdf_response}    ${vendor_contact_value}    ELSE    Verify String Does Not Contain Substring    ${pdf_response}    ${vendor_contact_value}
    Run Keyword If    "${vendor_contact_number_value}"!="null"    Verify String Contains Substring    ${pdf_response}    ${vendor_contact_number_value}    ELSE    Verify String Does Not Contain Substring    ${pdf_response}    ${vendor_contact_number_value}
    Verify String Contains Substring X Times    ${pdf_response}    ${vendor_name_value}    2
    Verify String Contains Substring    ${pdf_response}    ${vendor_address_1_value}
    Verify String Contains Substring    ${pdf_response}    ${vendor_address_2_value}
    Verify String Contains Substring    ${pdf_response}    ${vendor_city_value}
    Verify String Contains Substring    ${pdf_response}    ${vendor_country_value}
    : FOR    ${index}    IN RANGE    0    ${eo_remarks_data_length}
    \    Verify String Contains Substring    ${pdf_response}    ${eo_remark_text_${index}}   

Verify Exchange Order Number Is Returned Correctly
    ${exchange_order_number}    Get Json Value As String    ${response.content}    $.eoNumber
    Set Test Variable    ${exchange_order_number}   
    ${eo_year}    Get Substring    ${exchange_order_number}    0    2
    ${eo_month}    Get Substring    ${exchange_order_number}    2    4
    ${eo_market}    Get Substring    ${exchange_order_number}    4    5   
    ${eo_sequence}    Get Substring    ${exchange_order_number}    5    10
    Verify Actual Value Matches Expected Value   ${eo_year}    ${current_year}
    Verify Actual Value Matches Expected Value   ${eo_month}    ${current_month}
    Verify Actual Value Matches Expected Value   ${eo_market}    ${market}
    Verify String Matches Pattern    ${eo_sequence}    ^[0-9_]*$
    
Verify Exchange Order Is Saved Correctly
    Verify Json Value Is Correct    $.accountNumber    ${account_number_value}
    Verify Json Value Is Correct    $.additionalInfoDate    ${date_value}
    Verify Json Value Is Correct    $.agentId    ${agent_id_value}
    Verify Json Value Is Correct    $.agentName    ${agent_name_value}
    Run Keyword If    "${bta_description_value}"!="null"    Verify Json Value Is Correct    $.btaDescription    ${bta_description_value}    ELSE    Verify Json Element Does Not Exist    $.btaDescription
    Verify Json Value Is Correct    $.commission    ${commission_value}
    Verify Json Value Is Correct    $.countryCode    ${country_value} 
    ${expected_date_time}    Get Substring    ${current_date_time}    0    18
    ${expected_date_time}    Replace String    ${expected_date_time}    ${SPACE}    T
    ${actual_date_time}    Get Json Value As String    ${response.content}    $.createDateTime
    ${actual_date_time}    Get Substring    ${actual_date_time}    0    18
    Verify Actual Value Matches Expected Value    ${actual_date_time}    ${expected_date_time}
    Verify Json Value Matches Pattern    $.createDateTime    ^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9].[0-9][0-9][0-9]Z+$
    Run Keyword If    "${cc_type_value}"!="null"    Verify Json Value Is Correct    $.creditCard.ccType    ${cc_type_value} 
    Run Keyword If    "${cc_number_value}"!="null"    Verify Json Value Is Correct    $.creditCard.ccNumber    ${cc_number_value} 
    Run Keyword If    "${expiry_date_value}"!="null"    Verify Json Value Is Correct    $.creditCard.expiryDate    ${expiry_date_value}
    Verify Json Value Is Correct    $.description    ${description_value}
    Verify Json Value Is Correct    $.eoAction    ${eo_action_value}
    Verify Json Value Is Correct    $.eoNumber    ${exchange_order_number}
    Verify Json Value Is Correct    $.fopType    ${fop_type_value}
    Run Keyword If    "${gst_absorb_value}"!="null"    Verify Json Value Is Correct    $.gstAbsorb    ${gst_absorb_value}    ELSE    Verify Json Element Does Not Exist    $.gstAbsorb
    Verify Json Value Is Correct    $.gstAmount    ${gst_amount_value}
    Verify Json Value Is Correct    $.header.address    ${header_address_value}
    Run Keyword If    "${header_fax_value}"!="null"    Verify Json Value Is Correct    $.header.faxNumber    ${header_fax_value}    ELSE    Verify Json Element Does Not Exist    $.header.faxNumber
    Run Keyword If    "${header_telephone_value}"!="null"    Verify Json Value Is Correct    $.header.phoneNumber    ${header_telephone_value}    ELSE    Verify Json Element Does Not Exist    $.phoneNumber
    Verify Json Value Is Correct    $.merchantFee    ${merchant_fee_value}
    Run Keyword If    "${merchant_fee_absorb_value}"!="null"    Verify Json Value Is Correct    $.merchantFeeAbsorb    ${merchant_fee_absorb_value}    ELSE    Verify Json Element Does Not Exist    $.merchantFeeAbsorb
    Verify Json Value Is Correct    $.nettCost    ${nett_cost_value}
    Verify Json Value Is Correct    $.passengerName    ${passenger_name_value}
    Verify Json Value Is Correct    $.pcc    ${pcc_value}  
    Verify Json Value Is Correct    $.productCode    ${product_code_value}
    Run Keyword If    "${raise_cheque_value}"!="null"    Verify Json Value Is Correct    $.raiseCheque    ${raise_cheque_value}    ELSE    Verify Json Element Does Not Exist    $.raiseCheque
    Verify Json Value Is Correct    $.recordLocator    ${record_locator_value}
    Verify Json Value Is Correct    $.sellingPrice    ${selling_price_value}
    Verify Json Value Is Correct    $.status    ${status_value}
    Run Keyword If    "${tax_1_value}"!="null"    Verify Json Value Is Correct    $.tax1    ${tax_1_value}    ELSE    Verify Json Element Does Not Exist    $.tax1
    Run Keyword If    "${tax_2_value}"!="null"    Verify Json Value Is Correct    $.tax2    ${tax_2_value}    ELSE    Verify Json Element Does Not Exist    $.tax2
    Verify Json Value Is Correct    $.total    ${total_value}
    Verify Json Value Is Correct    $.totalSellingPrice    ${total_selling_price_value}
    Run Keyword If    "${vendor_email_value}"!="null"    Verify Json Value Is Correct    $.vendor.email    ${vendor_email_value}    ELSE    Verify Json Element Does Not Exist    $.vendor.email
    Run Keyword If    "${vendor_fax_value}"!="null"    Verify Json Value Is Correct    $.vendor.faxNumber    ${vendor_fax_value}    ELSE    Verify Json Element Does Not Exist    $.vendor.faxNumber
    Run Keyword If    "${vendor_contact_value}"!="null"    Verify Json Value Is Correct    $.vendor.contactPerson    ${vendor_contact_value}    ELSE    Verify Json Element Does Not Exist    $.vendor.contactPerson
    Verify Json Value Is Correct    $.vendor.code    ${vendor_code_value}
    Run Keyword If    "${vendor_address_1_value}"!="null"    Verify Json Value Is Correct    $.vendor.address1    ${vendor_address_1_value}    ELSE    Verify Json Element Does Not Exist    $.vendor.address
    Run Keyword If    "${vendor_address_2_value}"!="null"    Verify Json Value Is Correct    $.vendor.address2    ${vendor_address_2_value}    ELSE    Verify Json Element Does Not Exist    $.vendor.address2
    Run Keyword If    "${vendor_city_value}"!="null"    Verify Json Value Is Correct    $.vendor.city    ${vendor_city_value}    ELSE    Verify Json Element Does Not Exist    $.vendor.city
    Run Keyword If    "${vendor_country_value}"!="null"    Verify Json Value Is Correct    $.vendor.country    ${vendor_country_value}    ELSE    Verify Json Element Does Not Exist    $.vendor.country
    Run Keyword If    "${vendor_name_value}"!="null"    Verify Json Value Is Correct    $.vendor.name    ${vendor_name_value}    ELSE    Verify Json Element Does Not Exist    $.vendor.name
    : FOR    ${index}    IN RANGE    0    ${eo_remarks_data_length}
    \    Verify Json Value Is Correct    $.eoRemarks.[${index}]    ${eo_remark_text_${index}}
    : FOR    ${index}    IN RANGE    0    ${itin_remarks_data_length}
    \    Verify Json Value Is Correct    $.itineraryRemarks.[${index}]    ${itin_remark_text_${index}}


Verify Exchange Order Is Not Returned
    Verify String Does Not Contain Substring    ${response.text}    "accountNumber"    
    Verify String Does Not Contain Substring    ${response.text}    "additionalInfoDate"
    Verify String Does Not Contain Substring    ${response.text}    "agentId"
    Verify String Does Not Contain Substring    ${response.text}    "agentName"
    Verify String Does Not Contain Substring    ${response.text}    "btaDescription"
    Verify String Does Not Contain Substring    ${response.text}    "commission"
    Verify String Does Not Contain Substring    ${response.text}    "countryCode"
    Verify String Does Not Contain Substring    ${response.text}    "createDateTime"
    Verify String Does Not Contain Substring    ${response.text}    "creditCard"
    Verify String Does Not Contain Substring    ${response.text}    "description"
    Verify String Does Not Contain Substring    ${response.text}    "eoAction"
    Verify String Does Not Contain Substring    ${response.text}    "eoNumber"
    Verify String Does Not Contain Substring    ${response.text}    "eoRemarks"
    Verify String Does Not Contain Substring    ${response.text}    "fopType"
    Verify String Does Not Contain Substring    ${response.text}    "gstAmount"
    Verify String Does Not Contain Substring    ${response.text}    "gstAbsorb"
    Verify String Does Not Contain Substring    ${response.text}    "header"
    Verify String Does Not Contain Substring    ${response.text}    "itineraryRemarks"
    Verify String Does Not Contain Substring    ${response.text}    "merchantFee"
    Verify String Does Not Contain Substring    ${response.text}    "merchantFeeAbsorb"
    Verify String Does Not Contain Substring    ${response.text}    "nettCost"
    Verify String Does Not Contain Substring    ${response.text}    "passengerName"
    Verify String Does Not Contain Substring    ${response.text}    "pcc"
    Verify String Does Not Contain Substring    ${response.text}    "productCode"
    Verify String Does Not Contain Substring    ${response.text}    "raiseCheque"
    Verify String Does Not Contain Substring    ${response.text}    "recordLocator"
    Verify String Does Not Contain Substring    ${response.text}    "sellingPrice"
    Verify String Does Not Contain Substring    ${response.text}    "tax1"
    Verify String Does Not Contain Substring    ${response.text}    "tax2"
    Verify String Does Not Contain Substring    ${response.text}    "total"
    Verify String Does Not Contain Substring    ${response.text}    "totalSellingPrice"
    Verify String Does Not Contain Substring    ${response.text}    "vendor"

Verify Static Labels Is Retrieved Correctly
    Verify String Contains Substring    ${pdf_response}    Carlson Wagonlit Singapore Pte Ltd (Reg. No. 199600179G)
    Verify String Contains Substring    ${pdf_response}    Tel:
    Verify String Contains Substring    ${pdf_response}    Fax:
    Verify String Contains Substring    ${pdf_response}    ATTN:
    Verify String Contains Substring    ${pdf_response}    EXCHANGE ORDER
    Verify String Contains Substring    ${pdf_response}    EO Number
    Verify String Contains Substring    ${pdf_response}    Passenger Name
    Verify String Contains Substring    ${pdf_response}    Agent Name
    Verify String Contains Substring    ${pdf_response}    Agent ID
    Verify String Contains Substring    ${pdf_response}    Record Locator
    Verify String Contains Substring X Times    ${pdf_response}    Tel    2
    Verify String Contains Substring    ${pdf_response}    To
    Verify String Contains Substring    ${pdf_response}    Fax
    Verify String Contains Substring    ${pdf_response}    Email
    Verify String Contains Substring    ${pdf_response}    Date
    Verify String Contains Substring    ${pdf_response}    SERVICE INFO
    Verify String Contains Substring    ${pdf_response}    Nett Cost
    Run Keyword If    "${gst_amount_value}"!="null" or "${gst_amount_value}"!="0"    Verify String Contains Substring    ${pdf_response}    GST
    Run Keyword If    "${gst_amount_value}"=="null" or "${gst_amount_value}"=="0"    Verify String Contains Substring X Times    ${pdf_response}    Tax    2    ELSE IF    "${gst_amount_value}"!="null" or "${gst_amount_value}"!="0"    Verify String Contains Substring X Times    ${pdf_response}    Tax    1
    Verify String Contains Substring    ${pdf_response}    Total
    Verify String Contains Substring    ${pdf_response}    Description
    Verify String Contains Substring    ${pdf_response}    Remarks
    Verify String Contains Substring    ${pdf_response}    Please prepare document for our collection today.
    Verify String Contains Substring    ${pdf_response}    Thank you.